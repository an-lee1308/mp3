CREATE DATABASE QLGV

USE QLGV

/*PHAN 1*/
/*CAU 1*/
CREATE TABLE KHOA(
	MAKHOA VARCHAR(4),
	TENKHOA VARCHAR(40),
	NGTLAP SMALLDATETIME,
	TRGKHOA CHAR(4),
	PRIMARY KEY (MAKHOA) 
)

CREATE TABLE MONHOC(
	MAMH VARCHAR(10),
	TENMH VARCHAR(40),
	TCLT TINYINT,
	TCTH TINYINT,
	MAKHOA VARCHAR(4)
	PRIMARY KEY (MAMH)
)

CREATE TABLE DIEUKIEN(
	MAMH VARCHAR(10),
	MAMH_TRUOC VARCHAR(10),
	PRIMARY KEY (MAMH, MAMH_TRUOC)
)

CREATE TABLE GIAOVIEN(
	MAGV CHAR(4),
	HOTEN VARCHAR(40),
	HOCVI VARCHAR(10),
	HOCHAM VARCHAR(10),
	GIOITINH VARCHAR(3),
	NGSINH SMALLDATETIME,
	NGVL SMALLDATETIME,
	HESO NUMERIC(4,2),
	MUCLUONG MONEY,
	MAKHOA VARCHAR(4),
	PRIMARY KEY (MAGV)
)

CREATE TABLE LOP(
	MALOP CHAR(3),
	TENLOP VARCHAR(40),
	TRGLOP CHAR(5),
	SISO TINYINT,
	MAGVCN CHAR(4),
	PRIMARY KEY (MALOP)
)

CREATE TABLE HOCVIEN(
	MAHV CHAR(5),
	HO VARCHAR(40),
	TEN VARCHAR(10),
	NGSINH SMALLDATETIME,
	GIOITINH VARCHAR(3),
	NOISINH VARCHAR(40),
	MALOP CHAR(3),
	PRIMARY KEY (MAHV)
)

CREATE TABLE GIANGDAY(
	MALOP CHAR(3),
	MAMH VARCHAR(10),
	MAGV CHAR(4),
	HOCKY TINYINT,
	NAM SMALLINT,
	TUNGAY SMALLDATETIME,
	DENNGAY SMALLDATETIME,
	PRIMARY KEY (MALOP, MAMH)
)

CREATE TABLE KETQUATHI(
	MAHV CHAR(5),
	MAMH VARCHAR(10),
	LANTHI TINYINT,
	NGTHI SMALLDATETIME,
	DIEM NUMERIC(4,2),
	KQUA VARCHAR(10),
	PRIMARY KEY(MAHV, MAMH, LANTHI)
)

ALTER TABLE HOCVIEN
ADD CONSTRAINT FK_HOCVIEN_LOP FOREIGN KEY (MALOP) REFERENCES LOP(MALOP)

ALTER TABLE LOP
ADD CONSTRAINT FK_LOP_TRUONGLOP FOREIGN KEY (TRGLOP) REFERENCES HOCVIEN(MAHV)

ALTER TABLE LOP
ADD CONSTRAINT FK_LOP_GVCN FOREIGN KEY(MAGVCN) REFERENCES GIAOVIEN(MAGV)

ALTER TABLE KHOA
ADD CONSTRAINT FK_KHOA_TRGKHOA FOREIGN KEY(TRGKHOA) REFERENCES GIAOVIEN(MAGV)

ALTER TABLE MONHOC
ADD CONSTRAINT FK_MONHOC_KHOA FOREIGN KEY (MAKHOA) REFERENCES KHOA(MAKHOA)

ALTER TABLE DIEUKIEN
ADD CONSTRAINT FK_DIEUKIEN_MONHOC FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH)

ALTER TABLE DIEUKIEN
ADD CONSTRAINT FK_DIEUKIEN_MONHOCTRUOC FOREIGN KEY (MAMH_TRUOC) REFERENCES MONHOC(MAMH)

ALTER TABLE GIAOVIEN
ADD CONSTRAINT FK_GIAOVIEN_KHOA FOREIGN KEY (MAKHOA) REFERENCES KHOA(MAKHOA)

ALTER TABLE GIANGDAY
ADD CONSTRAINT FK_GIANGDAY_LOP FOREIGN KEY (MALOP) REFERENCES LOP(MALOP)

ALTER TABLE GIANGDAY
ADD CONSTRAINT FK_GIANGDAY_MON FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH)

ALTER TABLE KETQUATHI
ADD CONSTRAINT FK_KETQUATHI_HOCVIEN FOREIGN KEY (MAHV) REFERENCES HOCVIEN(MAHV)

ALTER TABLE KETQUATHI
ADD CONSTRAINT FK_KETQUATHI_MONHOC FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMH)

ALTER TABLE HOCVIEN
ADD GHICHU VARCHAR(50) 

ALTER TABLE HOCVIEN
ADD DIEMTB NUMERIC(4,2)

ALTER TABLE HOCVIEN
ADD XEPLOAI VARCHAR(10)

/*CAU 2*/
ALTER TABLE HOCVIEN
ADD CONSTRAINT CHK_MAHV CHECK(SUBSTRING(MAHV, 1,3) = MALOP AND ISNUMERIC(SUBSTRING(MAHV, 4,2)) = 1)

/*CAU 3*/
ALTER TABLE HOCVIEN
ADD CONSTRAINT CHK_GIOITINH CHECK(GIOITINH IN ('Nam', 'Nu'))

/*CAU 4*/
ALTER TABLE KETQUATHI
ADD CONSTRAINT CHK_DIEM CHECK(DIEM <= 10 AND DIEM >= 0)

/*CAU 5*/
ALTER TABLE KETQUATHI
ADD CONSTRAINT CHK_KQUA CHECK ((KQUA = 'Dat' AND DIEM >= 5) OR (KQUA = 'Khong dat' AND DIEM < 5))

/*CAU 6*/
ALTER TABLE KETQUATHI
ADD CONSTRAINT CHK_LANTHI CHECK (LANTHI <= 3)

/*CAU 7*/
ALTER TABLE GIANGDAY
ADD CONSTRAINT CHK_HOCKY CHECK(HOCKY IN (1,2,3))

/*CAU 8*/
ALTER TABLE GIAOVIEN
ADD CONSTRAINT CHK_HOCVI CHECK(HOCVI IN ('CN', 'KS', 'ThS', 'TS', 'PTS'))

/*CAU 9*/
CREATE TRIGGER TRG_LOP_LOPTRUONG ON LOP
FOR INSERT
AS
BEGIN
	DECLARE @MAHV CHAR(5), @TRGLOP CHAR(5), @MALOP CHAR(3)

	SELECT @TRGLOP=TRGLOP, @MALOP = MALOP FROM inserted

	SELECT @MAHV=MAHV FROM HOCVIEN WHERE MAHV = @TRGLOP AND MALOP = @MALOP

	IF (@MAHV <> @TRGLOP) 
		BEGIN
			PRINT 'LOI! TRUONG LOP PHAI LA HOC VIEN CUA LOP'
			ROLLBACK TRANSACTION
		END
	ELSE
		PRINT 'THANH CONG'

END

/*CAU 10*/
CREATE TRIGGER TRG_GIAOVIEN_TRUONGKHOA ON KHOA
FOR INSERT, UPDATE
AS 
BEGIN
	DECLARE @MAGV CHAR(4), @MAKHOA CHAR(4), @TRGKHOA CHAR(4)

	SELECT @MAKHOA = MAKHOA, @TRGKHOA = TRGKHOA FROM inserted

	SELECT @MAGV = MAGV FROM GIAOVIEN WHERE MAKHOA=@MAKHOA AND MAGV=@TRGKHOA AND HOCVI IN ('TS', 'PTS')

	IF (@MAGV <> @TRGKHOA) 
		BEGIN 
			PRINT 'LOI! TRUONG KHOA PHAI LA GIAO VIEN KHOA VA CO HOC VI TS HOAC PTS'
			ROLLBACK TRANSACTION
		END
	ELSE
		PRINT 'THANH CONG'
END

/*CAU 11*/
ALTER TABLE HOCVIEN
ADD CONSTRAINT CHK_HOCVIEN_TUOI CHECK(YEAR(GETDATE()) - YEAR(NGSINH) >= 18)

/*CAU 12*/
ALTER TABLE GIANGDAY
ADD CONSTRAINT CHK_GIANGDAY_NGAY CHECK(TUNGAY < DENNGAY)

/*CAU 13*/
ALTER TABLE GIAOVIEN
ADD CONSTRAINT CHK_GIAOVIEN_TUOI CHECK(YEAR(NGVL) - YEAR(NGSINH) >= 22)

/*CAU 14*/
ALTER TABLE MONHOC
ADD CONSTRAINT CHK_MONHOC_TINCHI CHECK(ABS(TCLT - TCTH) <= 3)

/*CAU 15*/
CREATE TRIGGER TRG_HV_THI
ON KETQUATHI
FOR INSERT
AS
BEGIN
	DECLARE @MAHV CHAR(5), @MALOP CHAR(3), @MAMH VARCHAR(10), @NGKT SMALLDATETIME, @NGTHI SMALLDATETIME

	SELECT @MAHV=inserted.MAHV, @MAMH=MAMH, @MALOP=MALOP, @NGTHI=NGTHI FROM inserted INNER JOIN HOCVIEN ON inserted.MAHV = HOCVIEN.MAHV

	SELECT @NGKT=DENNGAY FROM GIANGDAY WHERE MALOP=@MALOP AND MAMH=@MAMH

	IF (@NGTHI < @NGKT)
		BEGIN
			PRINT 'lOI !. NGAY THI PHAI LON HON NGAY KET THUC MON HOC'
			ROLLBACK TRANSACTION
		END
	ELSE
		PRINT 'THANH CONG'
END

/*CAU 16*/
CREATE TRIGGER TRG_MH_HK
ON GIANGDAY
FOR INSERT
AS
BEGIN
	DECLARE @SOMH INT, @HOCKY TINYINT, @NAM SMALLINT, @MALOP CHAR(3), @SOMH_HIENTAI INT

	SELECT @SOMH=COUNT(MAMH), @HOCKY=HOCKY, @NAM=NAM, @MALOP=MALOP FROM inserted GROUP BY HOCKY, NAM, MALOP

	SELECT @SOMH_HIENTAI=COUNT(MAMH) FROM GIANGDAY WHERE MALOP = @MALOP AND HOCKY = @HOCKY AND NAM = @NAM
	GROUP BY MALOP, HOCKY, NAM

	IF ((@SOMH_HIENTAI + @SOMH) > 3)
		BEGIN
			PRINT 'LOI! MOI HOC KY TRONG NAM 1 LOP CO TOI DA 3 MON HOC'
			ROLLBACK TRANSACTION
		END
	ELSE
		PRINT 'THANH CONG'
END

/*cau 17*/
CREATE TRIGGER TRG_LOP_SS
ON LOP
FOR UPDATE
AS 
BEGIN
	DECLARE @TONGSL INT, @MALOP CHAR(3), @SSHT INT, @SS INT

	SELECT @MALOP=MALOP FROM inserted

	SELECT @SS=SISO FROM LOP WHERE MALOP=@MALOP

	SELECT @TONGSL=COUNT(MAHV) FROM HOCVIEN WHERE MALOP=@MALOP GROUP BY MALOP

	IF (@SS = @TONGSL)
		BEGIN
			PRINT ('lOI! SI SO LOP PHAI BANG TONG SO HOC VIEN LOP DO')
		END
	ELSE
		PRINT 'THANH CONG'
END

/*CAU 18 */
CREATE TRIGGER TRG_DK_MH
ON DIEUKIEN
FOR INSERT
AS
BEGIN
	DECLARE @MAMH VARCHAR(10), @MAMH_TRUOC VARCHAR(10)

	SELECT @MAMH = MAMH, @MAMH_TRUOC = MAMH_TRUOC FROM inserted

	IF EXISTS(SELECT * FROM DIEUKIEN WHERE MAMH = @MAMH_TRUOC AND MAMH_TRUOC=MAMH)
		BEGIN
			PRINT 'LOI! MAMH VA MAMH TRUOC KHONG DUOC HOAN DOI CHO NHAU'
			ROLLBACK TRANSACTION
		END
	ELSE
		PRINT 'THANH CONG'
END

/*CAU 19*/
CREATE TRIGGER TRG_GV_ML
ON GIAOVIEN
FOR INSERT, UPDATE
AS 
BEGIN
	DECLARE @HOCHAM VARCHAR(10), @HOCVI VARCHAR(10), @ML MONEY, @MLHT MONEY

	SELECT @HOCHAM = HOCHAM, @HOCVI = HOCVI, @ML = MUCLUONG FROM inserted

	SELECT @MLHT=MUCLUONG FROM GIAOVIEN WHERE HOCHAM=@HOCHAM AND HOCVI=@HOCVI

	IF (@ML <> @MLHT)
		BEGIN
			PRINT 'LOI! CAC GIAO VIEN CUNG HOC HAM VA HOC VI THI MUC LUONG BANG NHAU'
			ROLLBACK TRANSACTION
		END
	ELSE 
		PRINT 'THANH CONG'
END

/*CAU 20*/
CREATE TRIGGER TRG_HV_LT
ON KETQUATHI
FOR INSERT
AS
BEGIN
	DECLARE @MAMH VARCHAR(10), @MAHV CHAR(5), @LTMN INT, @DIEMHT NUMERIC(4,2)
	
	SELECT @LTMN = LANTHI, @MAMH = MAMH, @MAHV = MAHV FROM inserted

	SELECT @DIEMHT=DIEM FROM KETQUATHI WHERE MAHV = @MAHV AND MAMH = @MAMH AND LANTHI = @LTMN - 1

	IF (@LTMN > 1 AND @DIEMHT > 5)
		BEGIN
			PRINT 'LOI! HOC VIEN CHI DUOC THI LAI NEU LAN THI TRUOC DIEM DUOI 5'
			ROLLBACK TRANSACTION
		END
	ELSE
		PRINT 'THANH CONG'
END

/*CAU 21*/
CREATE TRIGGER TRG_KQ_NGTHI
ON KETQUATHI
FOR INSERT
AS
BEGIN
	DECLARE @MAMH VARCHAR(10), @MAHV CHAR(5), @LTMN INT, @NGTHIMN SMALLDATETIME, @NGTHIHT SMALLDATETIME
	
	SELECT @LTMN = LANTHI, @MAMH = MAMH, @MAHV = MAHV, @NGTHIMN = NGTHI FROM inserted

	SELECT @NGTHIHT=NGTHI FROM KETQUATHI WHERE MAHV = @MAHV AND MAMH = @MAMH AND LANTHI = @LTMN - 1

	IF (@NGTHIHT > @NGTHIMN)
		BEGIN
			PRINT 'LOI! NGAY THI LAN SAU PHAI LON HON NGAY THI LAN TRUOC'
			ROLLBACK TRANSACTION
		END
	ELSE
		PRINT 'THANH CONG'
END

/*CAU 22*/
CREATE TRIGGER TRG_KQTHI_LOP_NGKT
ON KETQUATHI
FOR INSERT
AS 
BEGIN
	DECLARE @MAMH VARCHAR(10), @MALOP CHAR(3), @NGKT SMALLDATETIME, @NGTHI SMALLDATETIME

	SELECT @MALOP = MALOP, @MAMH = MAMH, @NGTHI = NGTHI FROM inserted INNER JOIN HOCVIEN ON inserted.MAHV = HOCVIEN.MAHV

	SELECT @NGKT=DENNGAY FROM GIANGDAY WHERE MALOP = @MALOP AND MAMH = @MAMH

	IF (@NGTHI <= @NGKT)
		BEGIN 
			PRINT 'LOI! HOC VIEN CHI DUOC THI KHI LOP HOC VIEN HOC XONG MON HOC'
			ROLLBACK TRANSACTION
		END
	ELSE
		PRINT 'THANH CONG'
END

/*CAU 23*/
CREATE TRIGGER TRG_MH_MHTRUOC
ON GIANGDAY
FOR INSERT
AS
BEGIN
	DECLARE @MAMH VARCHAR(10), @MALOP CHAR(3)

	SELECT @MAMH = MAMH, @MALOP=MALOP FROM inserted

	IF NOT EXISTS (
			SELECT * FROM GIANGDAY INNER JOIN DIEUKIEN AS P ON GIANGDAY.MAMH = P.MAMH WHERE GIANGDAY.MAMH = @MAMH AND MALOP = @MALOP AND EXISTS (
			SELECT * FROM GIANGDAY AS Q WHERE Q.MAMH = P.MAMH_TRUOC)
		) 
		BEGIN
			PRINT 'LOI! CHUA PHAN CONG GIANG DAY CAC MON HOC TRUOC MON HOC HIEN TAI'
			ROLLBACK TRANSACTION
		END
	ELSE
		PRINT 'THANH CONG'
END

/*CAU 24*/
CREATE TRIGGER TRG_MH_GD 
ON GIANGDAY
FOR INSERT 
AS
BEGIN
	DECLARE @MAKHOAMH VARCHAR(4), @MAKHOAGV VARCHAR(4), @MAMH VARCHAR(10)

	SELECT @MAKHOAGV=inserted.MAGV, @MAMH = MAMH FROM inserted INNER JOIN GIAOVIEN ON GIAOVIEN.MAGV = inserted.MAGV

	SELECT @MAKHOAMH = MAKHOA FROM MONHOC WHERE MAMH = @MAMH

	IF (@MAKHOAGV <> @MAKHOAMH)
		BEGIN
			PRINT 'LOI! GIAO VIEN CHI DUOC DAY NHUNG MON DO KHOA PHU TRACH'
			ROLLBACK TRANSACTION
		END
	ELSE
		PRINT 'THANH CONG'
END


/*phan 2*/
/*cau 0 */
SET DATEFORMAT DMY
INSERT INTO KHOA (MAKHOA, TENKHOA, NGTLAP) VALUES ('KHMT', 'Khoa Hoc May Tinh', '7/6/2005')
INSERT INTO KHOA (MAKHOA, TENKHOA, NGTLAP) VALUES ('HTTT', 'He thong thong tin', '7/6/2005')
INSERT INTO KHOA (MAKHOA, TENKHOA, NGTLAP) VALUES ('CNPM', 'Cong nghe phan mem', '7/6/2005')
INSERT INTO KHOA (MAKHOA, TENKHOA, NGTLAP) VALUES ('MTT', 'Mang va truyen thong', '7/6/2005')
INSERT INTO KHOA (MAKHOA, TENKHOA, NGTLAP) VALUES ('KTMT', 'Ky thuat may tinh', '7/6/2005')

INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV01', 'Ho Thanh Son', 'PTS', 'GS', 'Nam', '2/5/1950', '1/11/2004', 5.00, 2250000, 'KHMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV02', 'Tran Tam Thanh', 'TS', 'PGS', 'Nam', '17/12/1965', '20/4/2004', 4.50, 2025000, 'HTTT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV03', 'Do Nghiem Phung', 'TS', 'GS', 'Nu', '1/8/1950', '23/9/2004', 4.00, 1800000, 'CNPM')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV04', 'Tran Nam Son', 'TS', 'PGS', 'Nam', '22/2/1961', '12/1/2005', 4.50, 2025000, 'KTMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV05', 'Mai Thanh Danh', 'ThS', 'GV', 'Nam', '12/3/1958', '12/1/2005', 3.00, 1350000, 'HTTT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV06', 'Tran Doan Hung', 'TS', 'GV', 'Nam', '11/3/1953', '12/1/2005', 4.50, 2025000, 'KHMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV07', 'Nguyen Minh Tien', 'ThS', 'GV', 'Nam', '23/11/1971', '1/3/2005', 4.00, 1800000, 'KHMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV08', 'Le Thi Tran', 'KS', Null, 'Nu', '26/3/1974', '1/3/2005', 1.69, 760500, 'KHMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV09', 'Nguyen To Lan', 'ThS', 'GV', 'Nu', '31/12/1966', '1/3/2005', 4.00, 1800000, 'HTTT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV10', 'Le Tran Anh Loan', 'KS', Null, 'Nu', '17/7/1972', '1/3/2005', 1.86, 837000, 'CNPM')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV11', 'Ho Thanh Tung', 'CN', 'GV', 'Nam', '12/1/1980', '15/5/2005', 2.67, 1201500, 'MTT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV12', 'Tran Van Anh', 'CN', Null, 'Nu', '29/3/1981', '15/5/2005', 1.69, 760500, 'CNPM')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV13', 'Nguyen Linh Dan', 'CN', Null, 'Nu', '23/5/1980', '15/5/2005', 1.69, 760500, 'KTMT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV14', 'Truong Minh Chau', 'ThS', 'GV', 'Nu', '30/11/1976', '15/5/2005', 3.00, 1350000, 'MTT')
INSERT INTO GIAOVIEN (MAGV, HOTEN, HOCVI, HOCHAM, GIOITINH, NGSINH, NGVL, HESO, MUCLUONG, MAKHOA) VALUES ('GV15', 'Le Ha Thanh', 'ThS', 'GV', 'Nam', '4/5/1978', '15/5/2005', 3.00, 1350000, 'KHMT')

UPDATE KHOA SET TRGKHOA = 'GV01' WHERE MAKHOA = 'KHMT'
UPDATE KHOA SET TRGKHOA = 'GV02' WHERE MAKHOA = 'HTTT'
UPDATE KHOA SET TRGKHOA = 'GV04' WHERE MAKHOA = 'CNPM'
UPDATE KHOA SET TRGKHOA = 'GV03' WHERE MAKHOA = 'MTT'

INSERT INTO LOP (MALOP, TENLOP, SISO, MAGVCN) VALUES ('K11', 'Lop 1 khoa 1', 11, 'GV07')
INSERT INTO LOP (MALOP, TENLOP, SISO, MAGVCN) VALUES ('K12', 'Lop 2 khoa 1', 12, 'GV09')
INSERT INTO LOP (MALOP, TENLOP, SISO, MAGVCN) VALUES ('K13', 'Lop 3 khoa 1', 12, 'GV14')

INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('THDC', 'Tin hoc dai cuong', 4, 1, 'KHMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('CTRR', 'Cau truc roi rac', 5, 0, 'KHMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('CSDL', 'Co so du lieu', 3, 1, 'HTTT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('CTDLGT', 'Cau truc du lieu va giai thuat', 3, 1, 'KHMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('PTTKTT', 'Phan tich thiet ke thuat toan', 3, 0, 'KHMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('DHMT', 'Do hoa may tinh', 3, 1, 'KHMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('KTMT', 'Kien truc may tinh', 3, 1, 'KTMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('TKCSDL', 'Thiet ke co so du lieu', 3, 0, 'HTTT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('PTTKHTTT', 'Phan tich thiet ke he thong thong tin', 4, 1, 'HTTT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('HDH', 'He dieu hanh', 4, 0, 'KTMT')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('NMCNPM', 'Nhap mon cong nghe phan mem', 3, 0, 'CNPM')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('LTCFW', 'Lap trinh C for win', 3, 1, 'CNPM')
INSERT INTO MONHOC (MAMH, TENMH, TCLT, TCTH, MAKHOA) VALUES ('LTHDT', 'Lap trinh huong doi tuong', 3, 1, 'CNPM')

SET DATEFORMAT DMY

INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1101', 'Nguyen Van', 'A', '27/1/1986', 'Nam','TpHCM', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1102', 'Tran Ngoc', 'Han', '14/3/1986', 'Nu','Kien Giang', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1103', 'Ha Duy', 'Lap', '18/4/1986', 'Nam','Nghe An', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1104', 'Tran Ngoc', 'Linh', '30/3/1986', 'Nu','Tay Ninh', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1105', 'Tran Minh', 'Long', '27/2/1986', 'Nam','TpHCM', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1106', 'Le Nhat', 'Minh', '24/1/1986', 'Nam','TpHCM', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1107', 'Nguyen Nhu', 'Nhut', '27/1/1986', 'Nam','Ha Noi', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1108', 'Nguyen Manh', 'Tam', '27/2/1986', 'Nam','Kien Giang', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1109', 'Phan Thi Thanh', 'Tam', '27/1/1986', 'Nu','Vinh Long', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1110', 'Le Hoai', 'Thuong', '5/2/1986', 'Nu','Can Tho', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1111', 'Le Ha', 'Vinh', '25/12/1986', 'Nam','Vinh Long', 'K11')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1201', 'Nguyen Van', 'B', '11/2/1986', 'Nam','TpHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1202', 'Nguyen Thi Kim', 'Duyen', '18/11/1986', 'Nu','TpHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1203', 'Tran Thi Kim', 'Duyen', '17/9/1986', 'Nu','TpHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1204', 'Truong My', 'Hanh', '19/5/1986', 'Nu','Dong Nai', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1205', 'Nguyen Thanh', 'Nam', '17/4/1986', 'Nam','TpHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1206', 'Nguyen Thi Truc', 'Thanh', '4/3/1986', 'Nu','Kien Giang', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1207', 'Tran Thi Bich', 'Thuy', '8/2/1986', 'Nu','Nghe An', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1208', 'Huynh Thi Kim', 'Trieu', '8/4/1986', 'Nu','Tay Ninh', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1209', 'Pham Thanh', 'Trieu', '23/2/1986', 'Nam','TpHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1210', 'Ngo Thanh', 'Tuan', '14/2/1986', 'Nam','TpHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1211', 'Do Thi', 'Xuan', '9/3/1986', 'Nu','Ha Noi', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1212', 'Le Thi Phi', 'Yen', '12/3/1986', 'Nu','TpHCM', 'K12')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1301', 'Nguyen Thi Kim', 'Cuc', '9/6/1986', 'Nu','Kien Giang', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1302', 'Truong Thi My', 'Hien', '18/3/1986', 'Nu','Nghe An', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1303', 'Le Duc', 'Hien', '21/3/1986', 'Nam','Tay Ninh', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1304', 'Le Quang', 'Hien', '18/4/1986', 'Nam','TpHCM', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1305', 'Le Thi', 'Huong', '27/3/1986', 'Nu','TpHCM', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1306', 'Nguyen Thai', 'Huu', '30/3/1986', 'Nam','Ha Noi', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1307', 'Tran Minh', 'Man', '28/5/1986', 'Nam','TpHCM', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1308', 'Nguyen Hieu', 'Nghia', '8/4/1986', 'Nam','Kien Giang', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1309', 'Nguyen Trung', 'Nghia', '18/1/1987', 'Nam','Nghe An', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1310', 'Tran Thi Hong', 'Than', '22/4/1986', 'Nu','Tay Ninh', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1311', 'Tran Minh', 'Thuc', '4/4/1986', 'Nam','TpHCM', 'K13')
INSERT INTO HOCVIEN (MAHV, HO, TEN, NGSINH, GIOITINH, NOISINH, MALOP) VALUES ('K1312', 'Nguyen Thi Kim', 'Yen', '7/9/1986', 'Nu','TpHCM', 'K13')

UPDATE LOP SET TRGLOP = 'K1108' WHERE MALOP = 'K11'
UPDATE LOP SET TRGLOP = 'K1205' WHERE MALOP = 'K12'
UPDATE LOP SET TRGLOP = 'K1305' WHERE MALOP = 'K13'

INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('CSDL', 'CTRR')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('CSDL', 'CTDLGT')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('CTDLGT', 'THDC')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('PTTKTT', 'THDC')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('PTTKTT', 'CTDLGT')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('DHMT', 'THDC')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('LTHDT', 'THDC')
INSERT INTO DIEUKIEN (MAMH, MAMH_TRUOC) VALUES ('PTTKHTTT', 'CSDL')

SET DATEFORMAT DMY
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1101','CSDL', 1, '20/7/2006', 10.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1101', 'CTDLGT', 1,  '28/12/2006', 9.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1101', 'THDC', 1, '20/5/2006', 9.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1101', 'CTRR', 1, '13/5/2006', 9.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1102', 'CSDL', 1, '20/7/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1102', 'CSDL', 2, '27/7/2006', 4.25, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1102', 'CSDL', 3, '10/8/2006', 4.50, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1102', 'CTDLGT', 1, '28/12/2006', 4.50, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1102', 'CTDLGT', 2, '5/1/2007', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1102', 'CTDLGT', 3, '15/1/2007', 6.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1102', 'THDC', 1, '20/5/2006', 5.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1102', 'CTRR', 1, '13/5/2006',7.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1103', 'CSDL', 1, '20/7/2006', 3.50, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1103', 'CSDL', 2, '27/7/2006', 8.25, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1103', 'CTDLGT', 1, '28/12/2006', 7.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1103', 'THDC', 1, '20/5/2006', 8.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1103', 'CTRR', 1, '13/5/2006', 6.50, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1104', 'CSDL', 1, '20/7/2006', 3.75, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1104', 'CTDLGT', 1, '28/12/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1104', 'CTRR', 1, '20/5/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1104', 'THDC', 1, '13/5/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1104', 'CTRR', 2, '20/5/2006', 3.50, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1104', 'CTRR', 3, '30/5/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1201', 'CSDL', 1, '20/7/2006', 6.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1201', 'CTDLGT', 1, '28/12/2006', 5.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1201', 'THDC', 1, '20/5/2006', 8.50, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1201', 'CTRR', 1, '13/5/2006', 9.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1202', 'CSDL', 1, '20/7/2006', 8.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1202', 'CTDLGT', 1, '28/12/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1202', 'CTDLGT', 2, '5/1/2007', 5.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1202', 'THDC', 1, '20/5/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1202', 'THDC', 2, '27/5/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1202', 'CTRR', 1, '13/5/2006', 3.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1202', 'CTRR', 2, '20/5/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1202', 'CTRR', 3, '30/6/2006', 6.25, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1203', 'CSDL', 1, '20/7/2006', 9.25, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1203', 'CTDLGT', 1, '28/12/2006', 9.50, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1203', 'THDC', 1, '20/5/2006', 10.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1203', 'CTRR', 1, '13/5/2006', 10.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1204', 'CSDL', 1, '20/7/2006', 8.50, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1204', 'CTDLGT', 1, '28/12/2006', 6.75, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1204', 'THDC', 1, '20/5/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1204', 'CTRR', 1, '13/5/2006', 6.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1301', 'CSDL', 1, '20/12/2006', 4.25, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1301', 'CTDLGT', 1, '25/7/2006', 8.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1301', 'THDC', 1, '20/5/2006', 7.75, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1301', 'CTRR', 1, '13/5/2006', 8.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1302', 'CSDL', 1, '20/12/2006', 6.75, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1302', 'CTDLGT', 1, '25/7/2006', 5.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1302', 'THDC', 1, '20/5/2006', 8.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1302', 'CTRR', 1, '13/5/2006', 8.50, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1303', 'CSDL', 1, '20/12/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1303', 'CTDLGT', 1, '25/7/2006', 4.50, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1303', 'CTDLGT', 2, '7/8/2006', 4.00, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1303', 'CTDLGT', 3, '15/8/2006', 4.25, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1303', 'THDC', 1, '20/5/2006', 4.50, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1303', 'CTRR', 1, '13/5/2006', 3.25, 'Khong Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1303', 'CTRR', 2, '20/5/2006', 5.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1304', 'CSDL', 1, '20/12/2006', 7.75, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1304', 'CTDLGT', 1, '25/7/2006', 9.75, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1304', 'THDC', 1, '20/5/2006', 5.50, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1304', 'CTRR', 1, '13/5/2006', 5.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1305', 'CSDL', 1, '20/12/2006', 9.25, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1305', 'CTDLGT', 1, '25/7/2006', 10.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1305', 'THDC', 1, '20/5/2006', 8.00, 'Dat')
INSERT INTO KETQUATHI (MAHV, MAMH, LANTHI, NGTHI, DIEM, KQUA) VALUES ('K1305', 'CTRR', 1, '13/5/2006', 10.00, 'Dat')

SET DATEFORMAT DMY
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'THDC', 'GV07', 1, 2006, '2/1/2006', '12/5/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K12', 'THDC', 'GV06', 1, 2006, '2/1/2006', '12/5/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K13', 'THDC', 'GV15', 1, 2006, '2/1/2006', '12/5/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'CTRR', 'GV02', 1, 2006, '9/1/2006', '17/5/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K12', 'CTRR', 'GV02', 1, 2006, '9/1/2006', '17/5/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K13', 'CTRR', 'GV08', 2, 2006, '9/1/2006', '17/5/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'CSDL', 'GV05', 2, 2006, '1/6/2006', '15/7/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K12', 'CSDL', 'GV09', 2, 2006, '1/6/2006', '15/7/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K13', 'CTDLGT', 'GV15', 2, 2006, '1/6/2006', '15/7/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K13', 'CSDL', 'GV05', 3, 2006, '1/8/2006', '15/12/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K13', 'DHMT', 'GV07', 3, 2006, '1/8/2006', '15/12/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'CTDLGT', 'GV15', 3, 2006, '1/8/2006', '15/12/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K12', 'CTDLGT', 'GV15', 3, 2006, '1/8/2006', '15/12/2006')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'HDH', 'GV04', 1, 2007, '2/1/2007', '18/2/2007')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K12', 'HDH', 'GV04', 1, 2007, '2/1/2007', '20/3/2007')
INSERT INTO GIANGDAY(MALOP, MAMH, MAGV, HOCKY, NAM, TUNGAY, DENNGAY) VALUES ('K11', 'DHMT', 'GV07', 1, 2007, '2/1/2007', '20/3/2007')



/*cau 1 */
UPDATE GIAOVIEN
SET HESO = HESO + 0.2
WHERE MAGV IN (SELECT TRGKHOA FROM KHOA)

/*cau 2*/
UPDATE HOCVIEN
SET DIEMTB = (SELECT TOP 1 DIEM FROM KETQUATHI WHERE MAHV=HOCVIEN.MAHV ORDER BY DIEM)

/*CAU 3*/
UPDATE HOCVIEN
SET GHICHU = 'CAM THI'
WHERE EXISTS (SELECT * FROM KETQUATHI WHERE MAHV = HOCVIEN.MAHV AND DIEM < 5 AND LANTHI = 3)

/*CAU 4*/
UPDATE HOCVIEN
SET XEPLOAI = 'XS' WHERE DIEMTB >= 9

UPDATE HOCVIEN
SET XEPLOAI = 'G' WHERE DIEMTB >=8 AND DIEMTB < 9

UPDATE HOCVIEN
SET XEPLOAI = 'K' WHERE DIEMTB >=6.5 AND DIEMTB < 8

UPDATE HOCVIEN
SET	XEPLOAI = 'TB' WHERE DIEMTB >= 5 AND DIEMTB < 6.5

UPDATE HOCVIEN
SET XEPLOAI = 'Y' WHERE DIEMTB < 5

/*PHAN 3*/
/*CAU 1*/
SELECT TRGLOP, CONCAT(HO, TEN) AS HOTEN, NGSINH, LOP.MALOP FROM LOP INNER JOIN HOCVIEN ON HOCVIEN.MAHV = LOP.TRGLOP

/*CAU 2*/
SELECT HOCVIEN.MAHV, CONCAT(HO, TEN) AS HOTEN, LANTHI, DIEM FROM KETQUATHI INNER JOIN HOCVIEN ON HOCVIEN.MAHV = KETQUATHI.MAHV
WHERE MAMH='CTRR' AND MALOP='K12'
ORDER BY TEN, HO

/*CAU 3*/
SELECT HOCVIEN.MAHV, CONCAT(HO, TEN) AS HOTEN, KETQUATHI.MAMH, TENMH FROM KETQUATHI INNER JOIN HOCVIEN ON HOCVIEN.MAHV = KETQUATHI.MAHV INNER JOIN MONHOC ON MONHOC.MAMH = KETQUATHI.MAMH
WHERE LANTHI = 1 AND KQUA = 'Dat'

/*CAU 4*/
SELECT HOCVIEN.MAHV, CONCAT(HO, TEN) AS HOTEN FROM KETQUATHI INNER JOIN HOCVIEN ON HOCVIEN.MAHV = KETQUATHI.MAHV
WHERE LANTHI = 1 AND KQUA = 'Khong Dat' AND MALOP = 'K11' AND MAMH = 'CTRR'

/*CAU 5*/
SELECT DISTINCT HOCVIEN.MAHV, CONCAT(HO, TEN) AS HOTEN FROM KETQUATHI INNER JOIN HOCVIEN ON HOCVIEN.MAHV = KETQUATHI.MAHV
WHERE KQUA = 'Khong Dat' AND SUBSTRING(MALOP,1,1) = 'K'

/*CAU 6*/
SELECT DISTINCT TENMH FROM MONHOC INNER JOIN GIANGDAY ON MONHOC.MAMH = GIANGDAY.MAMH INNER JOIN GIAOVIEN ON GIAOVIEN.MAGV = GIANGDAY.MAGV
WHERE GIAOVIEN.HOTEN = 'Tran Tam Thanh' AND HOCKY = 1 AND NAM = 2006

/*CAU 7*/
SELECT GIANGDAY.MAMH, TENMH FROM GIANGDAY INNER JOIN MONHOC ON GIANGDAY.MAMH = MONHOC.MAMH
WHERE MAGV = (SELECT MAGVCN FROM LOP WHERE MALOP='K11')

/*CAU 8*/
SELECT CONCAT(HO, TEN) FROM HOCVIEN WHERE MAHV IN (
	SELECT TRGLOP FROM LOP INNER JOIN GIANGDAY ON LOP.MALOP = GIANGDAY.MALOP INNER JOIN GIAOVIEN ON GIAOVIEN.MAGV = GIANGDAY.MAGV INNER JOIN MONHOC ON GIANGDAY.MAMH = MONHOC.MAMH
	WHERE HOTEN = 'Nguyen To Lan' AND TENMH = 'Co So Du Lieu'
)

/*CAU 9*/
SELECT MAMH, TENMH FROM MONHOC
WHERE MAMH IN (SELECT MAMH_TRUOC FROM DIEUKIEN INNER JOIN MONHOC ON MONHOC.MAMH = DIEUKIEN.MAMH WHERE TENMH = 'Co So Du Lieu')


/*CAU 10*/
SELECT DIEUKIEN.MAMH, TENMH FROM DIEUKIEN INNER JOIN MONHOC ON DIEUKIEN.MAMH = MONHOC.MAMH
WHERE MAMH_TRUOC = (SELECT MAMH FROM MONHOC WHERE TENMH = 'Cau Truc Roi Rac')

/*CAU 11*/
SELECT HOTEN FROM GIAOVIEN WHERE MAGV IN (
	SELECT MAGV FROM GIANGDAY WHERE MALOP='K11' AND HOCKY = 1 AND NAM = 2006
	UNION 
	SELECT MAGV FROM GIANGDAY WHERE MALOP='K12' AND HOCKY = 1 AND NAM = 2006
)

/*CAU 12*/
SELECT CONCAT(HO, TEN) AS HOTEN FROM HOCVIEN
WHERE MAHV IN (
	SELECT MAHV FROM KETQUATHI WHERE LANTHI = 1 AND KQUA = 'Khong Dat'
	EXCEPT
	SELECT MAHV FROM KETQUATHI WHERE LANTHI > 1
)

/*CAU 13*/
SELECT GIAOVIEN.MAGV, HOTEN FROM GIAOVIEN
EXCEPT 
SELECT GIANGDAY.MAGV, HOTEN FROM GIANGDAY INNER JOIN GIAOVIEN ON GIAOVIEN.MAGV = GIANGDAY.MAGV

/*CAU 14*/
SELECT MAGV, HOTEN FROM GIAOVIEN AS GV WHERE NOT EXISTS (
	SELECT * FROM GIANGDAY WHERE MAGV = GV.MAGV AND MAKHOA = GV.MAKHOA
)

/*CAU 15*/
SELECT CONCAT(HO, TEN) AS HOTEN FROM HOCVIEN 
WHERE MAHV IN (
	SELECT MAHV FROM KETQUATHI WHERE LANTHI >=3 AND KQUA = 'Khong Dat'
	UNION
	SELECT MAHV FROM KETQUATHI WHERE LANTHI = 2 AND DIEM = 5 AND MAMH = 'CTRR'
)

/*CAU 16*/
SELECT MAGV, HOTEN FROM GIAOVIEN
WHERE MAGV IN (
	SELECT MAGV FROM GIANGDAY 
	WHERE MAMH = 'CTRR'
	GROUP BY MAGV, HOCKY, NAM
	HAVING COUNT(MAMH) >= 2
)

/*CAU 17*/
SELECT KQ.MAHV, CONCAT(HO, TEN) AS HOTEN, KQ.MAMH, LANTHI, DIEM FROM KETQUATHI AS KQ 
INNER JOIN MONHOC AS MH ON KQ.MAMH = MH.MAMH INNER JOIN HOCVIEN ON KQ.MAHV = HOCVIEN.MAHV
WHERE TENMH = 'Co So Du Lieu' AND LANTHI = (
	SELECT MAX(LANTHI) FROM KETQUATHI WHERE MAMH = MH.MAMH AND MAHV = KQ.MAHV
)

/*CAU 18*/
SELECT KQ.MAHV, CONCAT(HO, TEN) AS HOTEN, KQ.MAMH, LANTHI, DIEM FROM KETQUATHI AS KQ 
INNER JOIN MONHOC AS MH ON KQ.MAMH = MH.MAMH INNER JOIN HOCVIEN ON KQ.MAHV = HOCVIEN.MAHV
WHERE TENMH = 'Co So Du Lieu' AND DIEM = (
	SELECT MAX(DIEM) FROM KETQUATHI WHERE MAMH = MH.MAMH AND MAHV = KQ.MAHV
)

/*CAU 19*/
SELECT MAKHOA, TENKHOA FROM KHOA
WHERE NGTLAP = (SELECT MIN(NGTLAP) FROM KHOA)

/*CAU 20*/
SELECT HOCHAM, COUNT(MAGV) AS SL FROM GIAOVIEN
WHERE HOCHAM = 'GS' OR HOCHAM = 'PGS'
GROUP BY HOCHAM

/*CAU 21*/
SELECT MAKHOA, HOCHAM, COUNT(MAGV) AS SL FROM GIAOVIEN
GROUP BY HOCHAM, MAKHOA

/*CAU 22*/
SELECT MAMH, KQUA, COUNT(MAHV) AS SL FROM KETQUATHI
GROUP BY MAMH, KQUA

/*CAU 23*/
SELECT MAGV, HOTEN FROM GIAOVIEN AS GV
WHERE EXISTS (
	SELECT MAGVCN FROM LOP AS L WHERE MAGVCN = GV.MAGV AND EXISTS (
		SELECT MAGV FROM GIANGDAY WHERE MAGV = GV.MAGV AND MALOP = L.MALOP
	)
) 

/*CAU 24*/
SELECT CONCAT(HO, TEN) FROM HOCVIEN
WHERE MAHV IN (
	SELECT TRGLOP FROM LOP INNER JOIN HOCVIEN ON HOCVIEN.MALOP = LOP.MALOP
	GROUP BY TRGLOP, LOP.MALOP
	HAVING COUNT(MAHV) = (
		SELECT MAX(SL_HV) FROM (
			SELECT LOP.MALOP, TRGLOP, COUNT(MAHV) AS SL_HV FROM LOP INNER JOIN HOCVIEN ON HOCVIEN.MALOP = LOP.MALOP
			GROUP BY LOP.MALOP, TRGLOP
		) AS T
	)
)

/*CAU 25*/
SELECT CONCAT(HO, TEN) AS HOTEN FROM HOCVIEN
WHERE MAHV IN (
	SELECT TRGLOP FROM LOP AS L INNER JOIN KETQUATHI ON L.TRGLOP = KETQUATHI.MAHV
	WHERE DIEM < 5
	GROUP BY TRGLOP
	HAVING COUNT(MAHV) >= 3
)

/*CAU 26*/
SELECT MAHV, CONCAT(HO, TEN) AS HOTEN FROM HOCVIEN
WHERE MAHV IN (
	SELECT MAHV FROM KETQUATHI WHERE DIEM = 9 OR DIEM = 10
	GROUP BY MAHV
	HAVING COUNT(DIEM) = (
		SELECT MAX(SL_DIEM) FROM (
			SELECT MAHV, COUNT(DIEM) AS SL_DIEM FROM KETQUATHI WHERE DIEM = 9 OR DIEM = 10
			GROUP BY MAHV
		) AS T
	)
)

/*CAU 27*/
SELECT	B.MALOP,A.MAHV, HO, TEN
FROM	KETQUATHI A, HOCVIEN B
WHERE	A.MAHV=B.MAHV AND (DIEM=9 OR DIEM=10) 
GROUP BY  B.MALOP, A.MAHV, HO, TEN
HAVING	COUNT(MAMH)>=ALL(
	SELECT 	COUNT(MAMH)
	FROM	KETQUATHI C, HOCVIEN D
	WHERE	C.MAHV=D.MAHV AND B.MALOP=D.MALOP AND (DIEM=9 OR DIEM=10)
	GROUP BY C.MAHV
)

/*CAU 28*/
SELECT	NAM, HOCKY, MAGV, COUNT(MALOP) AS SL_LOP, COUNT(MAMH) AS SL_MON
FROM GIANGDAY
GROUP BY HOCKY, NAM, MAGV

/*CAU 29*/
SELECT	NAM, HOCKY, A.MAGV, HOTEN, COUNT(MALOP) AS SL_LOP
FROM		GIANGDAY A, GIAOVIEN B
WHERE	A.MAGV=B.MAGV
GROUP BY	HOCKY, NAM, A.MAGV, HOTEN
HAVING	COUNT(MALOP)>=ALL(	
	SELECT	COUNT(MALOP)
	FROM		GIANGDAY C
	WHERE	C.HOCKY=A.HOCKY AND C.NAM=A.NAM
	GROUP BY	C.MAGV) 

/*CAU 30*/
SELECT	A.MAMH, TENMH, COUNT(A.MAMH) AS SL
FROM	KETQUATHI A,MONHOC B
WHERE	A.MAMH=B.MAMH AND KQUA='Khong Dat' AND LANTHI=1
GROUP BY	A.MAMH, TENMH
HAVING	COUNT(A.MAMH) >= ALL(
	SELECT	COUNT(MAHV)
	FROM	KETQUATHI
	WHERE	KQUA='Khong Dat' AND LANTHI=1
	GROUP BY MAMH
)
/*CAU 31*/
SELECT	DISTINCT A.MAHV, HO, TEN
FROM		KETQUATHI A, HOCVIEN B
WHERE	A.MAHV=B.MAHV AND 
		A.MAHV NOT IN (
		SELECT	MAHV
		FROM		KETQUATHI
		WHERE	KQUA='Khong Dat' AND LANTHI=1
)

/*CAU 32*/
SELECT	DISTINCT A.MAHV, HO, TEN
FROM	KETQUATHI A, HOCVIEN B
WHERE	A.MAHV=B.MAHV AND A.MAHV NOT IN (
			SELECT	MAHV
			FROM		KETQUATHI C
			WHERE	KQUA='Khong Dat' AND LANTHI=(	
				SELECT	MAX(LANTHI)
				FROM		KETQUATHI D
				WHERE	C.MAHV=D.MAHV
			)
		)
/*CAU 33*/
SELECT MAHV, CONCAT(HO, TEN) AS HOTEN FROM HOCVIEN AS HV WHERE NOT EXISTS (
	SELECT * FROM MONHOC AS MH WHERE NOT EXISTS (
		SELECT * FROM KETQUATHI AS KQ WHERE LANTHI = 1 AND KQ.MAHV = HV.MAHV AND MH.MAMH = KQ.MAMH
	)
)

/*CAU 34*/
SELECT MAHV, CONCAT(HO, TEN) AS HOTEN FROM HOCVIEN AS HV WHERE NOT EXISTS (
	SELECT * FROM MONHOC AS MH WHERE NOT EXISTS (
		SELECT * FROM KETQUATHI AS KQ WHERE KQ.MAHV = HV.MAHV AND MH.MAMH = KQ.MAMH AND LANTHI = (
			SELECT MAX(LANTHI) FROM KETQUATHI WHERE MAHV = HV.MAHV AND MAMH = MH.MAMH
		)
	)
)

/*CAU 35*/
SELECT	A.MAMH,A.MAHV, HO, TEN, DIEM
FROM		KETQUATHI A, HOCVIEN B
WHERE	A.MAHV=B.MAHV
		AND DIEM>=ALL(
			SELECT	MAX(DIEM)
			FROM	KETQUATHI C
			WHERE	C.MAMH=A.MAMH
		)
		AND LANTHI=(
			SELECT	MAX(LANTHI)
			FROM KETQUATHI D
			WHERE	A.MAHV=D.MAHV AND D.MAMH=A.MAMH
		)
GROUP BY A.MAMH, A.MAHV, HO, TEN, DIEM